<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="24">
<Routine name="PNTDBSTOC01" type="INT" languagemode="0"><![CDATA[
PNTDBST0C01 ;;SUE@Trak; 01/01/98  DAY BOOK SPECIMEN TYPE ORDER CODES LIST ;   ; Compiled December 2, 1999 13:41:30 for Cache for Windows
 ;
 Q
 ;
print(ROWID,user,MSG) 
 S %="\",%U="" F I=1:1:132 S %U=%U_"-"
 S DATE=$$DE^TXBB
 D TIME^TXBB S TIME=w
 S ST=""
 I MSG="ALL" S MSG="" F  S MSG=$O(^TTAB("ST",MSG)) Q:MSG=""  D A100
 I MSG'="" D A100
 D K100
 Q
A100 S LAB=$P(^TTAB("LA",MSG),"\")
 S DEPC=$P(^TTAB("LA",MSG),"\",8)
 S DEPN=$P(^TTAB("DEP",DEPC),"\")
 D H100
 F I=1:1 S ST=$O(^TTAB("ST",MSG,ST)) Q:ST=""  D A200
 Q
 ; Cleanup, reset printer
K100 D ADD^SSPRINT(ROWID,"PRT",$C(27)_"(s0p10H")
 K ST,LAB,TTZH,TTZH1,MSG,DATE,TIME,TTD1
 Q
 ; 
A200 S TTZH=^TTAB("ST",MSG,ST)
 F I=1:1:2 S @("TTZH"_I)=$P(TTZH,"\",I)
 D ADD^SSPRINT(ROWID,"PRT","!")
 D ADD^SSPRINT(ROWID,"PRT","?0  "_ST)
 D ADD^SSPRINT(ROWID,"PRT","?11 "_TTZH1)
 D ADD^SSPRINT(ROWID,"PRT","?41 "_TTZH2)
 ; Now print standard cutup
 S BL="" 
 F  S BL=$O(^TTAB("ST",ST,BL)) Q:BL=""  D A220
 Q
 ; First the blocks
A220 S BL1=^TTAB("ST",ST,BL)
 D ADD^SSPRINT(ROWID,"PRT","?51 "_BL1)
 ; Then the procdeures
 S PR="" 
 F  S PR=$O(^TTAB("ST",ST,BL,PR)) Q:PR=""  D A230
 Q
A230 S PRA=^TTAB("ST",ST,BL,PR)
 F I=1:1:5 S @("PRA"_I)=$P(PRA,"\",I)       
 D ADD^SSPRINT(ROWID,"PRT","!")
 D ADD^SSPRINT(ROWID,"PRT","?61 "_PRA1)
 D ADD^SSPRINT(ROWID,"PRT","?81 "_PRA3)
 D ADD^SSPRINT(ROWID,"PRT","?91 "_PRA4)
 Q        
 ;Print header
H100 D ADD^SSPRINT(ROWID,"HDR",$C(27)_"(s0p16.67h0T")
 D ADD^SSPRINT(ROWID,"HDR","?0  PNTDBSTO01")
 D ADD^SSPRINT(ROWID,"HDR","?30 "_$P(^CF("SM",1),"^",6))
 D ADD^SSPRINT(ROWID,"HDR","?55 LABTRAK DAY BOOK SPECIMEN TYPE AND CUTUP CODES ")
 D ADD^SSPRINT(ROWID,"HDR","?105 "_DATE)
 D ADD^SSPRINT(ROWID,"HDR","?117 "_TIME)
 D ADD^SSPRINT(ROWID,"HDR","?130 "_"Page ")
 D ADD^SSPRINT(ROWID,"HDR","~PAGE")
 D ADD^SSPRINT(ROWID,"HDR","!") 
 D ADD^SSPRINT(ROWID,"HDR","?35 FOR DEPARTMENT ")
 D ADD^SSPRINT(ROWID,"HDR",DEPN_" - ")
 D ADD^SSPRINT(ROWID,"HDR",LAB_" LABORATORY")
 D ADD^SSPRINT(ROWID,"HDR","!")
 D ADD^SSPRINT(ROWID,"HDR","?0  "_%U)
 D ADD^SSPRINT(ROWID,"HDR","!")
 D ADD^SSPRINT(ROWID,"HDR","?0  CODE")
 D ADD^SSPRINT(ROWID,"HDR","?11 SPECIMEN")
 D ADD^SSPRINT(ROWID,"HDR","?41 T-CODE")
 D ADD^SSPRINT(ROWID,"HDR","?51 BLOCK")
 D ADD^SSPRINT(ROWID,"HDR","?61 PROCEDURE")
 D ADD^SSPRINT(ROWID,"HDR","?81 STAIN")
 D ADD^SSPRINT(ROWID,"HDR","?91 No OF")
 D ADD^SSPRINT(ROWID,"HDR","!")
 D ADD^SSPRINT(ROWID,"HDR","?51 NUMBER")
 D ADD^SSPRINT(ROWID,"HDR","?91 SLIDES") 
 D ADD^SSPRINT(ROWID,"HDR","?0  ----")
 D ADD^SSPRINT(ROWID,"HDR","?11 --------")
 D ADD^SSPRINT(ROWID,"HDR","?41 ------")
 D ADD^SSPRINT(ROWID,"HDR","?51 -----")
 D ADD^SSPRINT(ROWID,"HDR","?61 ---------")
 D ADD^SSPRINT(ROWID,"HDR","?81 -----")
 D ADD^SSPRINT(ROWID,"HDR","?91 ------")
 D ADD^SSPRINT(ROWID,"HDR","!")
 Q  
]]></Routine>
</Export>
