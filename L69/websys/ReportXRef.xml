<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="24">
<Class name="websys.ReportXRef">
<Description>
Cross Reference for report criteria</Description>
<ClassType>persistent</ClassType>
<ProcedureBlock>0</ProcedureBlock>
<Super>%Library.Persistent,websys.Abstract</Super>
<TimeCreated>60218,47035.393506</TimeCreated>
<Inheritance>right</Inheritance>

<Parameter name="BUILD">
<Internal/>
<Default>226</Default>
</Parameter>

<Parameter name="SQLDATEFROM">
<Internal/>
</Parameter>

<Parameter name="SQLDATETO">
<Internal/>
</Parameter>

<Parameter name="SQLCODE">
<Default>ID</Default>
</Parameter>

<Parameter name="SQLDESCRIPTION">
<Default>ID</Default>
</Parameter>

<Parameter name="SQLROWID">
<Default>ID</Default>
</Parameter>

<Index name="CareProvider">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>CareProvider,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="Hospital">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>Hospital,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="LetterType">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>LetterType,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="Location">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>Location,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="Location2">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>Location2,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="Module1">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>Module1,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="OrderItem">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>OrderItem,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="ReportReference">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>ReportReference,Report</Properties>
<Unique>0</Unique>
</Index>

<Index name="Trust">
<Extent>0</Extent>
<IdKey>0</IdKey>
<PrimaryKey>0</PrimaryKey>
<Properties>Trust,Report</Properties>
<Unique>0</Unique>
</Index>

<Property name="ApptCancelInitiator">
<Type>%Library.String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="ApptStatus">
<Type>%Library.String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="CareProvider">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Hospital">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="IntendedManagement">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Interpreter">
<Type>%String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="ItemCategory">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="LetterType">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Location">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Location2">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Module1">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="OrderItem">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="ReasonForRemoval">
<Description>
Reason For Removal</Description>
<Type>%String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="RefStatus">
<Type>%String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="RefStatusReason">
<Type>%String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Report">
<Type>websys.Report</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
</Property>

<Property name="ReportReference">
<Type>%Library.String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="StatePPP">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Transport">
<Type>%String</Type>
<Collection/>
<Relationship>0</Relationship>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="Trust">
<Type>%String</Type>
<Final>0</Final>
<Calculated>0</Calculated>
<Collection/>
<MultiDimensional>0</MultiDimensional>
<Private>0</Private>
<Relationship>0</Relationship>
<Required>0</Required>
<SqlComputed>0</SqlComputed>
<Transient>0</Transient>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Method name="CheckForDuplicateEntry">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>compref:%Library.String,id:%Library.String</FormalSpec>
<ReturnType>%Library.Boolean</ReturnType>
<Implementation><![CDATA[
 s retval=0
 s duplicate=0
 q retval
]]></Implementation>
</Method>

<Method name="FindAllClose">
<Final>0</Final>
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>QHandle:%Library.Binary</FormalSpec>
<PlaceAfter>FindAllFetch</PlaceAfter>
<Private>0</Private>
<ReturnType>%Library.Status</ReturnType>
<SqlProc>0</SqlProc>
<Implementation><![CDATA[
 n user,work
 ;
 s QHandle=""
 ;
 Quit $$$OK
]]></Implementation>
</Method>

<Method name="FindAllExecute">
<Description>
KK 3/Apr/2002 Log 24039 </Description>
<Final>0</Final>
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec><![CDATA[&QHandle:%Library.Binary,Report:%Library.String,Location:%Library.String,Module1:%Library.String,LetterType:%Library.String,ReportRef:%Library.String,ApptCancelInit:%Library.String,ApptStat:%Library.String,Interpreter:%Library.String,RefStat:%Library.String,RefStatReason:%Library.String,Transport:%Library.String,ReasonForRemoval:%Library.String]]></FormalSpec>
<Private>0</Private>
<ReturnType>%Library.Status</ReturnType>
<SqlProc>0</SqlProc>
<Implementation><![CDATA[
 n user,work
 ;
 s user=$lb(Report,Location)
 s work=$lb("")
 s QHandle=$lb(0,user,work)
 Q $$$OK
]]></Implementation>
</Method>

<Method name="FindAllFetch">
<Final>0</Final>
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec><![CDATA[&QHandle:%Library.Binary,&Row:%Library.List,&AtEnd:%Library.Integer=0]]></FormalSpec>
<PlaceAfter>FindAllExecute</PlaceAfter>
<Private>0</Private>
<ReturnType>%Library.Status</ReturnType>
<SqlProc>0</SqlProc>
<Implementation><![CDATA[
 n user,work
 s Row="",AtEnd=1 q $$$OK
 ;
 s QHandle=$lb(AtEnd,user,work)
 ;
 q $$$OK
]]></Implementation>
</Method>

<Method name="FindReportsForLetterTypeClose">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>QHandle:%Library.Binary</FormalSpec>
<PlaceAfter>FindAllFetch</PlaceAfter>
<ReturnType>%Library.Status</ReturnType>
<Implementation><![CDATA[
 n user,work
 ;
 s QHandle=""
 ;
 Quit $$$OK
]]></Implementation>
</Method>

<Method name="FindReportsForLetterTypeExecute">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec><![CDATA[&QHandle:%Library.Binary,desc:%Library.String,type:%Library.String]]></FormalSpec>
<PlaceAfter>GetIdFromCodeOrDescription</PlaceAfter>
<ReturnType>%Library.Status</ReturnType>
<Implementation><![CDATA[
 n user,work,hospital

 ;
 s user=$lb(desc,hospital,type)
 s work=$lb("")
 s QHandle=$lb(0,user,work)
 Q $$$OK
]]></Implementation>
</Method>

<Method name="FindReportsForLetterTypeFetch">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec><![CDATA[&QHandle:%Library.Binary,&Row:%Library.List,&AtEnd:%Library.Integer=0]]></FormalSpec>
<PlaceAfter>FindAllExecute</PlaceAfter>
<ReturnType>%Library.Status</ReturnType>
<Implementation><![CDATA[
 n user,work
 n ID, code, description
 ;
 s (ID, code, description)=""
 ;
 s AtEnd=$li(QHandle,1)
 s user=$li(QHandle,2)
 s work=$li(QHandle,3)
 s Row="",AtEnd=1 q $$$OK
 ;
 s QHandle=$lb(AtEnd,user,work)
 ;
 q $$$OK
]]></Implementation>
</Method>

<Method name="GetReport">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>Mod:%String="",LType:%String="",RepRef:%String="",Trst:%String="",Hosp:%String="",Loc:%String="",Loc2:%String="",CProv:%String="",StPPP:%String="",IntdMgmt:%String="",OrdSubCat:%String="",OrdItm:%String="",params:%String=""</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	; Log 54141 YC - Adding 6 new fields to ReportXRef. Params need to be passed in as below with "^" separator:
 ; params=ApptCancelInitiator_"^"_ApptStatus_"^"_Interpreter_"^"_RefStatus_"^"_RefStatusReason_"^"_Transport_"^"_ReasonForRemoval

	n code
	s code=""
	;s code=$$GetReport^CReportXRef(Mod,LType,RepRef,Trst,Hosp,Loc,Loc2,CProv,IntdMgmt,OrdItm,StPPP,OrdSubCat,params)
	q code
]]></Implementation>
</Method>

<Method name="GetReportByAppointment">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>AppID:%String="",Mod:%String="",LType:%String="",RepRef:%String=""</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	n ReportCode,Trst,Hosp,Loc,Loc2,CProv,StPPP,IntdMgmt,OrdSubCat,OrdItm,ResID,EpisodeID
	s (ReportCode,Trst,Hosp,Loc,Loc2,CProv,StPPP,IntdMgmt,OrdSubCat,OrdItm,ResID,EpisodeID)=""

	q ReportCode
]]></Implementation>
</Method>

<Method name="GetReportByEpisode">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>EpisodeID:%String="",Mod:%String="",LType:%String="",RepRef:%String=""</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	n ReportCode,Trst,Hosp,Loc,Loc2,CProv,StPPP,IntdMgmt,OrdSubCat,OrdItm,s1
	s (ReportCode,Trst,Hosp,Loc,Loc2,CProv,StPPP,IntdMgmt,OrdSubCat,OrdItm,s1)=""
	i EpisodeID="" q ReportCode
	s s1=$g(^PAADM(EpisodeID)),Loc=$p(s1,"^",4),CProv=$p(s1,"^",9)
	s OrdSubCat=$p(^PAADM((EpisodeID),2),"^",13)
	s Hosp=$p(^PAADM((EpisodeID),2),"^",85)
 i Hosp'="" s Trst=$p($g(^CT("HOSP",Hosp)),"^",6)
 s IntdMgmt=$p(^PAADM((EpisodeID),1),"^",6)
 s StPPP=$p(^PAADM((EpisodeID),2),"^",51)
 s ^zTRAK("karthi",$zn)="Mod="_Mod_",LType="_LType_",RepRef="_RepRef_",Trst="_Trst_",Hosp="_Hosp_",Loc="_Loc_",Loc2="_Loc2_",CProv="_CProv_",StPPP="_StPPP_",IntdMgmt="_IntdMgmt_",OrdSubCat="_OrdSubCat_",OrdItm="_OrdItm
 s ReportCode=##Class(websys.ReportXRef).GetReport(Mod,LType,RepRef,Trst,Hosp,Loc,Loc2,CProv,IntdMgmt,OrdItm,StPPP,OrdSubCat)
 q ReportCode
]]></Implementation>
</Method>

<Method name="GetReportByWaitingList">
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec>WaitingListID:%String="",Mod:%String="",LType:%String="",RepRef:%String=""</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	n ReportCode,Trst,Hosp,Loc,Loc2,CProv,StPPP,IntdMgmt,OrdSubCat,OrdItm,s1
	s (ReportCode,Trst,Hosp,Loc,Loc2,CProv,StPPP,IntdMgmt,OrdSubCat,OrdItm,s1)=""
	
	q ReportCode
]]></Implementation>
</Method>

<Method name="websysBeforeSave">
<Description><![CDATA[
Invoked before websysSave - can be used to cancel the save.<br>]]></Description>
<ClassMethod>1</ClassMethod>
<CodeMode>code</CodeMode>
<FormalSpec><![CDATA[compref:%String,&id:%String]]></FormalSpec>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
 n Validated
 s Validated=1
 ;
 ;s ^zkarthi($zn_"ID")=id
 ;KK 6/Aug/2003 Log 36095  
 i Validated s Validated='(##Class(websys.ReportXRef).CheckForDuplicateEntry(compref,id))
 q Validated
]]></Implementation>
</Method>

<Query name="FindAll">
<Description><![CDATA[
KK Log:24038
Query for websys.reportxref
KK 28/Oct/2002 Log 28995 added Module,LetterType & ReportRef to filter criteria
Log 53055 YC - Added ReasonForRemoval]]></Description>
<Type>%Library.Query</Type>
<FormalSpec>Report,CTLOCDesc,Module1,LetterType,ReportReference,ApptCancelInitiator,ApptStatus,Interpreter,RefStatus,RefStatusReason,Transport,ReasonForRemoval</FormalSpec>
<SqlProc>0</SqlProc>
<SqlQuery>
</SqlQuery>
<SqlView>0</SqlView>
<Parameter name="CONTAINID" value="1"/>
<Parameter name="ROWSPEC" value="ID, Report, Location, CareProvider, Hospital, IntendedManagement, OrderItem, Trust, LetterType, Location2, Module1, ReportReference, StatePPP, ApptCancelInitiator, ApptStatus, Interpreter, RefStatus, RefStatusReason, Transport, ReasonForRemoval"/>
</Query>

<Query name="FindReportParams">
<Description>
KK Log:24038
Query for report field lookup in websys.reportxref</Description>
<Type>%Library.SQLQuery</Type>
<FormalSpec>desc:%Library.String</FormalSpec>
<SqlProc>0</SqlProc>
<SqlQuery>SELECT ID,Code,Description,ReportUrl,Type FROM 
websys.Report Where ((%UPPER Description [ %UPPER :desc) OR (:desc IS NULL))
</SqlQuery>
<SqlView>0</SqlView>
<Parameter name="CONTAINID" value="0"/>
<Parameter name="ROWSPEC" value="HIDDEN,Code,Description,HIDDEN,HIDDEN"/>
</Query>

<Query name="FindReportsForLetterType">
<Type>%Library.Query</Type>
<FormalSpec>desc:%Library.String,type:%Library.String</FormalSpec>
<Parameter name="CONTAINID" value="1"/>
<Parameter name="ROWSPEC" value="HIDDEN,Code,Description"/>
</Query>

<Storage name="Default">
<Type>%Library.CacheStorage</Type>
<DataLocation>^websys.ReportXRefD</DataLocation>
<DefaultData>ReportXRefDefaultData</DefaultData>
<IdLocation>^websys.ReportXRefD</IdLocation>
<IndexLocation>^websys.ReportXRefI</IndexLocation>
<StreamLocation>^websys.ReportXRefS</StreamLocation>
<Data name="ReportXRefClassName">
<Attribute>%%CLASSNAME</Attribute>
<Structure>node</Structure>
<Subscript>0</Subscript>
</Data>
<Data name="ReportXRefDefaultData">
<Structure>listnode</Structure>
<Value name="1">
<Value>Hospital</Value>
</Value>
<Value name="2">
<Value>Report</Value>
</Value>
<Value name="3">
<Value>Trust</Value>
</Value>
<Value name="4">
<Value>CTLoc</Value>
</Value>
<Value name="5">
<Value>CareProvider</Value>
</Value>
<Value name="6">
<Value>IntendedManagement</Value>
</Value>
<Value name="7">
<Value>OrderItem</Value>
</Value>
<Value name="8">
<Value>Location</Value>
</Value>
<Value name="9">
<Value>LetterType</Value>
</Value>
<Value name="10">
<Value>Location2</Value>
</Value>
<Value name="11">
<Value>Module1</Value>
</Value>
<Value name="12">
<Value>ReportReference</Value>
</Value>
<Value name="13">
<Value>StatePPP</Value>
</Value>
<Value name="14">
<Value>ItemCategory</Value>
</Value>
<Value name="15">
<Value>ApptCancelInitiator</Value>
</Value>
<Value name="16">
<Value>ApptStatus</Value>
</Value>
<Value name="17">
<Value>Interpreter</Value>
</Value>
<Value name="18">
<Value>RefStatus</Value>
</Value>
<Value name="19">
<Value>RefStatusReason</Value>
</Value>
<Value name="20">
<Value>Transport</Value>
</Value>
<Value name="21">
<Value>ReasonForRemoval</Value>
</Value>
</Data>
</Storage>
</Class>
</Export>
