<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="24">
<Routine name="LVBCOM8091" type="INT" languagemode="0" generated="1"><![CDATA[
LVBCOM8091 ; IG 29/4/98 ; Common routines - conversion for 6.2
 q
start n
 ; set-up QC rules CT
 i '$d(^TTAB("QC-RULE","A")) s ^TTAB("QC-RULE","A")="1-2S\1\W\"
 i '$d(^TTAB("QC-RULE","B")) s ^TTAB("QC-RULE","B")="1-3S\2\R\"
 i '$d(^TTAB("QC-RULE","C")) s ^TTAB("QC-RULE","C")="2-2S\3\R\"
 i '$d(^TTAB("QC-RULE","D")) s ^TTAB("QC-RULE","D")="2 of 3S\4\R\"
 i '$d(^TTAB("QC-RULE","E")) s ^TTAB("QC-RULE","E")="4-1S\5\R\"
 i '$d(^TTAB("QC-RULE","F")) s ^TTAB("QC-RULE","F")="3-1S\6\R\"
 i '$d(^TTAB("QC-RULE","G")) s ^TTAB("QC-RULE","G")="10X\7\R\"
 i '$d(^TTAB("QC-RULE","H")) s ^TTAB("QC-RULE","H")="7X Trend\8\R\"
 i '$d(^TTAB("QC-RULE","I")) s ^TTAB("QC-RULE","I")="6X\9\R\"
 i '$d(^TTAB("QC-RULE","R")) s ^TTAB("QC-RULE","R")="R-4S\10\R\"
 ; set-up mmfields CT
 k ^TTAB("SV")
 s ^TTAB("SV","AMOUNT_BILLED")="Yes"
 s ^TTAB("SV","AMOUNT_OWING")="Yes"
 s ^TTAB("SV","AMOUNT_PAID")="Yes"
 s ^TTAB("SV","AMOUNT_TOTAL")="Yes"
 s ^TTAB("SV","BLOOD_GROUP")="Yes"
 s ^TTAB("SV","BLOOD_GROUP_ENTERED")="Yes"
 s ^TTAB("SV","BLOOD_GROUP_ORIGINAL")="Yes"
 s ^TTAB("SV","BILL_ADDR1")="Yes"
 s ^TTAB("SV","BILL_ADDR2")="Yes"
 s ^TTAB("SV","BILL_ADDR3")="Yes"
 s ^TTAB("SV","BILL_ADDR4")="Yes"
 s ^TTAB("SV","BILL_ADDR5")="Yes"
 s ^TTAB("SV","BILL_NAME")="Yes"
 s ^TTAB("SV","COMP_ADDR1")="Yes"
 s ^TTAB("SV","COMP_ADDR2")="Yes"
 s ^TTAB("SV","COMP_ADDR3")="Yes"
 s ^TTAB("SV","COMP_ADDR4")="Yes"
 s ^TTAB("SV","COMP_ADDR5")="Yes"
 s ^TTAB("SV","COMP_CODE")="Yes"
 s ^TTAB("SV","COMP_NAME")="Yes"
 s ^TTAB("SV","DATE_TODAY")="Yes"
 s ^TTAB("SV","TIME_TODAY")="Yes"
 s ^TTAB("SV","DOC_CODE")="Yes"
 s ^TTAB("SV","DOC_ADDR1")="Yes"
 s ^TTAB("SV","DOC_ADDR2")="Yes"
 s ^TTAB("SV","DOC_ADDR3")="Yes"
 s ^TTAB("SV","DOC_ADDR4")="Yes"
 s ^TTAB("SV","DOC_ADDR5")="Yes"
 s ^TTAB("SV","DOC_GIVENNAME")="Yes"
 s ^TTAB("SV","DOC_INITIAL")="Yes"
 s ^TTAB("SV","DOC_NAME")="Yes"
 s ^TTAB("SV","DOC_PHONE1")="Yes"
 s ^TTAB("SV","DOC_PHONE2")="Yes"
 s ^TTAB("SV","DOC_PHONE3")="Yes"
 s ^TTAB("SV","DOC_FAX")="Yes"
 s ^TTAB("SV","DOC_PROVIDER")="Yes"
 s ^TTAB("SV","DOC_SURNAME")="Yes"
 s ^TTAB("SV","DOC_TITLE")="Yes"
 s ^TTAB("SV","EXTRA_1")="Yes"
 s ^TTAB("SV","EXTRA_2")="Yes"
 s ^TTAB("SV","EXTRA_3")="Yes"
 s ^TTAB("SV","EXTRA_4")="Yes"
 s ^TTAB("SV","EXTRA_5")="Yes"
 s ^TTAB("SV","EXTRA_6")="Yes"
 s ^TTAB("SV","EXTRA_7")="Yes"
 s ^TTAB("SV","EXTRA_8")="Yes"
 s ^TTAB("SV","EXTRA_9")="Yes"
 s ^TTAB("SV","EXTRA_10")="Yes"
 s ^TTAB("SV","EXTRA_11")="Yes"
 s ^TTAB("SV","EXTRA_12")="Yes"
 s ^TTAB("SV","EXTRA_13")="Yes"
 s ^TTAB("SV","EXTRA_14")="Yes"
 s ^TTAB("SV","EXTRA_15")="Yes"
 s ^TTAB("SV","PAT_pc_MEDICARE")="Yes"
 s ^TTAB("SV","PAT_pc_DVA")="Yes"
 s ^TTAB("SV","PAT_pc_PENSIONER")="Yes"
 s ^TTAB("SV","PAT_ADDR1")="Yes"
 s ^TTAB("SV","PAT_ADDR2")="Yes"
 s ^TTAB("SV","PAT_ADDR3")="Yes"
 s ^TTAB("SV","PAT_ADDR4")="Yes"
 s ^TTAB("SV","PAT_ADDR5")="Yes"
 s ^TTAB("SV","PAT_CLN_NOTES")="Yes"
 s ^TTAB("SV","PAT_CATEGORY_CODE")="Yes"
 s ^TTAB("SV","PAT_CATEGORY_NAME")="Yes"
 s ^TTAB("SV","PAT_COLLECTION_DATE")="Yes"
 s ^TTAB("SV","PAT_COLLECTION_TIME")="Yes"
 s ^TTAB("SV","PAT_COPYTO")="Yes"
 s ^TTAB("SV","PAT_COPYTO_ADDR")="Yes"
 s ^TTAB("SV","PAT_COPYTO_ADDR1")="Yes"
 s ^TTAB("SV","PAT_COPYTO_ADDR2")="Yes"
 s ^TTAB("SV","PAT_COPYTO_ADDR3")="Yes"
 s ^TTAB("SV","PAT_COPYTO_ADDR4")="Yes"
 s ^TTAB("SV","PAT_COPYTO_ADDR5")="Yes"
 s ^TTAB("SV","PAT_COPYTO_NAME")="Yes"
 s ^TTAB("SV","PAT_DEBTOR")="Yes"
 s ^TTAB("SV","PAT_DOB")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_CODE")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_NAME")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_ADDR1")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_ADDR2")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_ADDR3")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_ADDR4")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_ADDR5")="Yes"
 s ^TTAB("SV","PAT_DOCTOR_REF")="Yes"
 s ^TTAB("SV","PAT_EPISODE")="Yes"
 s ^TTAB("SV","PAT_GIVENNAME")="Yes"
 s ^TTAB("SV","PAT_NAME")="Yes"
 s ^TTAB("SV","PAT_NAME_1")="Yes"
 s ^TTAB("SV","PAT_NAME_2")="Yes"
 s ^TTAB("SV","PAT_NAME_3")="Yes"
 s ^TTAB("SV","PAT_PAYCODE")="Yes"
 s ^TTAB("SV","PAT_PRIORITY")="Yes"
 s ^TTAB("SV","PAT_SEX_CODE")="Yes"
 s ^TTAB("SV","PAT_SEX")="Yes"
 s ^TTAB("SV","PAT_SURNAME")="Yes"
 s ^TTAB("SV","PAT_TESTS")="Yes"
 s ^TTAB("SV","PAT_TITLE")="Yes"
 s ^TTAB("SV","PAT_HOSPITAL_MRN")="Yes"
 s ^TTAB("SV","PAT_HOSPITAL_EPIS")="Yes"
 s ^TTAB("SV","PAT_ADMISSION_DATE")="Yes"
 s ^TTAB("SV","PAT_COLLECTED_BY")="Yes"
 s ^TTAB("SV","PAT_REQUEST_DATE")="Yes"
 s ^TTAB("SV","PAT_REQUEST_TIME")="Yes"
 s ^TTAB("SV","PAT_RECEIVED_DATE")="Yes"
 s ^TTAB("SV","PAT_RECEIVED_TIME")="Yes"
 s ^TTAB("SV","PAT_PHONE_HOME")="Yes"
 s ^TTAB("SV","PAT_PHONE_WORK")="Yes"
 s ^TTAB("SV","PAT_AGE")="Yes"
 s ^TTAB("SV","PAT_SPECIMENS_CODE")="Yes"
 s ^TTAB("SV","PAT_SPECIMENS_NAME")="Yes"
 s ^TTAB("SV","PAT_AB_REGISTRY")="Yes"
 s ^TTAB("SV","PAT_NationalID")="Yes"
 s ^TTAB("SV","PAT_BillLocation_CODE")="Yes"
 s ^TTAB("SV","PAT_BillLocation_NAME")="Yes"
 s ^TTAB("SV","PAT_UserSite_CODE")="Yes"
 s ^TTAB("SV","PAT_UserSite_NAME")="Yes"
 s ^TTAB("SV","PAT_Contract_CODE")="Yes"
 s ^TTAB("SV","PAT_Contract_NAME")="Yes"
 s ^TTAB("SV","PAT_HospitalRoom")="Yes"
 s ^TTAB("SV","PAT_HospitalBed")="Yes"
 s ^TTAB("SV","PL_CODE")="Yes"
 s ^TTAB("SV","PL_ADDR1")="Yes"
 s ^TTAB("SV","PL_ADDR2")="Yes"
 s ^TTAB("SV","PL_ADDR3")="Yes"
 s ^TTAB("SV","PL_ADDR4")="Yes"
 s ^TTAB("SV","PL_ADDR5")="Yes"
 s ^TTAB("SV","PL_FAX")="Yes"
 s ^TTAB("SV","PL_NAME")="Yes"
 s ^TTAB("SV","PL_PHONE")="Yes"
 s ^TTAB("SV","REPORT_TO_CODE")="Yes"
 s ^TTAB("SV","REPORT_TO_ADDR1")="Yes"
 s ^TTAB("SV","REPORT_TO_ADDR2")="Yes"
 s ^TTAB("SV","REPORT_TO_ADDR3")="Yes"
 s ^TTAB("SV","REPORT_TO_ADDR4")="Yes"
 s ^TTAB("SV","REPORT_TO_ADDR5")="Yes"
 s ^TTAB("SV","REPORT_TO_FAX")="Yes"
 s ^TTAB("SV","REPORT_TO_NAME")="Yes"
 s ^TTAB("SV","REPORT_TO_PHONE")="Yes"
 s ^TTAB("SV","TEST_AUTHORISED")="Yes"
 s ^TTAB("SV","TEST_ACCESSION")="Yes"
 s ^TTAB("SV","TEST_DATE_AUTHORISED")="Yes"
 s ^TTAB("SV","TEST_TIME_AUTHORISED")="Yes"
 s ^TTAB("SV","TEST_NAME")="Yes"
 s ^TTAB("SV","TEST_PATHOLOGIST")="Yes"
 s ^TTAB("SV","TEST_PRIORITY")="Yes"
 s ^TTAB("SV","TEST_REQUESTED_NAME")="Yes"
 s ^TTAB("SV","TEST_REQUESTED_SYNONYM")="Yes"
 s ^TTAB("SV","TEST_REQUESTED_REFERENCE")="Yes"
 s ^TTAB("SV","TEST_SYNONYM")="Yes"
 s ^TTAB("SV","TEST_SNOMED")="Yes"
 s ^TTAB("SV","TEST_CCR")="Yes"
 s ^TTAB("SV","TEST_DEPARTMENT")="Yes"
 s ^TTAB("SV","TEST_REFERENCE")="Yes"
 i '$d(^CF("CTPCT")) m ^CF("CTPCT")=^TTAB("CTPCT") k ^TTAB("CTPCT")
 ; create file
 s file="" i '$$select^MVBCFSM(1) s file=PLIST(15) i $l(file),"\/"'[$e(file,$l(file)) s file=file_$s(file["/":"/",1:"\")
 s line1="" s x="" f j=1:1 s x=$o(^TTAB("SV",x)) q:x=""  s $p(line1,",",j)=x
 s line2="" s x="" f j=1:1 s x=$o(^TTAB("SV",x)) q:x=""  s $p(line2,",",j)=""""""
 s dev=file_"mmfields.txt"
 o dev:"WNS":1 e  s dev="c:\mmfields.txt" o dev:"WNS":1 e  s dev="mmfields.txt" o dev:"WNS"
 u dev w line1,!,line2,! c dev
 w !!,"Created new < "_dev_" >",!!
 s dev=file_"mmfields_fax.txt"
 o dev:"WNS":1 e  s dev="c:\mmfields_fax.txt" o dev:"WNS":1 e  s dev="mmfields_fax.txt" o dev:"WNS"
 u dev w line1,!,line2,! c dev
 w !!,"Created new < "_dev_" >",!!
 w $$SQLclear^LVBCOM01(),!!
 w $$getall^LVBAUT(""),!!
 q
]]></Routine>
</Export>
