<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="24">
<Class name="UnitTest.BiRLab.CT.HospitalPaymentCategoryVersion">
<Super>UnitTest.TestCase</Super>
<TimeCreated>63347,56710.929077</TimeCreated>

<Method name="TestFindAnyObject">
<FormalSpec>pObject:BiRLab.CT.HospitalPaymentCategoryVersion</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set pObject="",ok=$$$OK
	try {
		set id=""
		&sql(DECLARE cur CURSOR FOR
	                 SELECT TOP 1 ID
	                 INTO :id
	                 from BiRLab_CT.HospitalPaymentCategoryVersion
	    )

        &sql(OPEN cur)
        &sql(FETCH cur)
                                  
        if (SQLCODE = 0) {
	        set pObject=##class(BiRLab.CT.HospitalPaymentCategoryVersion).%OpenId(id)
        } else {
	        set ok=$$$ERROR($$$GeneralError,"Нет ни одного объекта класса BiRLab.CT.HospitalPaymentCategoryVersion")
        }
        &sql(CLOSE cur)
        
	} catch(e) {
		set ok=e.AsStatus()
		set pObject=""
	}
	quit ok
]]></Implementation>
</Method>

<Method name="TestUpdate">
<Implementation><![CDATA[
	#dim obj As BiRLab.CT.HospitalPaymentCategoryVersion
	try {
		// тест объектного подхода
		set obj=""
		set ok=..TestFindAnyObject(.obj)
		do $$$AssertStatusOK(ok, "Нахождение какого-нибудь объекта класса BiRLab.CT.HospitalPaymentCategoryVersion")
		if $IsObject(obj) {
			set info=obj.Document_"1"
		    set obj.Document=info
		    //set hospital=obj.HospitalPaymentCategory.PayerHospital.Hospital.Code
		    //set payer=obj.HospitalPaymentCategory.PayerHospital.Payer.Code
		    //set date=obj.ActiveFrom
		    //set pricelist=obj.PriceList
		    set ok=obj.%Save()
		    do $$$AssertStatusOK(ok, "Сохрание объекта класса BiRLab.CT.HospitalPaymentCategoryVersion после корректировки (объектный метод)")
		    set info=$extract(info,1,$length(info)-1)
		    // тест SQL подхода
		    set id=obj.%Id()
		    &sql(UPDATE BiRLab_CT.HospitalPaymentCategoryVersion (Document) VALUES (:info) WHERE ID=:id)
		    set ok=1
		    if SQLCODE'=0 {
			    if ##class(%SYSTEM.Status).IsError(%objlasterror) {
			         set ok=%objlasterror
		        }  else {
			         Set ok=$$Error^%apiOBJ(5001,$ZERROR)  //$$Error^%apiOBJ(5001,$get(%objlasterror))
		        }
		    }
		    do $$$AssertStatusOK(ok, "Сохрание объекта класса BiRLab.CT.HospitalPaymentCategoryVersion после корректировки (SQL метод)")
		} else {
			$$$ThrowOnError($$$ERROR($$$GeneralError,"НЕ удалось найти объект BiRLab.CT.HospitalPaymentCategoryVersion"))
		}
		
	} catch(e) {
		throw e
	}
]]></Implementation>
</Method>
</Class>
</Export>
